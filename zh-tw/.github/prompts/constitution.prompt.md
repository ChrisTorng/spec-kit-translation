---
description: 從互動或提供的原則輸入建立或更新專案章程，確保所有相依範本保持同步。
---

使用者傳給你的輸入可以由 agent 直接提供或作為命令參數 - 在繼續處理提示前你**必須**考量它（如果不是空的）。

使用者輸入:

$ARGUMENTS

你正在更新位於 `.specify/memory/constitution.md` 的專案章程。此檔案為一個包含方括號佔位符（例如 `[PROJECT_NAME]`、`[PRINCIPLE_1_NAME]`）的範本。你的工作是 (a) 收集／推導具體值，(b) 精準填入範本，及 (c) 將任何修正傳播至相依產物。

遵循此執行流程：

1. 載入現有的範章範本位於 `.specify/memory/constitution.md`。
   - 辨識所有形式為 `[ALL_CAPS_IDENTIFIER]` 的佔位符。
   **重要**：使用者可能需要的原則數量會比範本中使用的少或多。如果指定了一個數量，請尊重該數量並遵循一般範本。你將相應更新文件。

2. 收集／推導佔位符的值：
   - 若使用者輸入（對話）提供了某值，請使用該值。
   - 否則從現有倉儲上下文（README、文件、之前的章程版本若有內嵌）推斷。
   - 對於治理日期：`RATIFICATION_DATE` 為原始採納日期（若未知則請求或標記 TODO），若有變更則 `LAST_AMENDED_DATE` 為今天，否則保留先前日期。
   - `CONSTITUTION_VERSION` 必須依語義版本控制規則遞增：
     * MAJOR：不相容的治理／原則移除或重新定義時。
     * MINOR：新增原則／章節或實質擴充指引時。
     * PATCH：澄清、措辭、拼字修正或非語義性精修時。
   - 若版本提升類型不明確，請在最終決定前提出推理說明。

3. 撰寫更新後的章程內容：
   - 將每一個佔位符替換為具體文字（除非專案選擇刻意保留尚未定義的範本欄位——對任何保留項目都要明確說明理由，不要留下方括號標記）。
   - 保留標題階層；註解在被替換後可以移除，除非仍有澄清用途。
   - 確保每個「原則」章節包含：簡潔的名稱行、說明不可協商規則的段落（或項目清單）、以及在非顯而易見時提供明確理由。
   - 確保「治理」章節列出修訂程序、版本政策與合規性審查預期。

4. 一致性傳播檢查表（將先前的檢查清單轉為主動驗證）：
   - 閱讀 `.specify/templates/plan-template.md` 並確保任何「Constitution Check」或規則與更新後的原則一致。
   - 閱讀 `.specify/templates/spec-template.md` 以確認範疇／需求的對齊——若章程新增或移除強制性章節或限制，請更新此檔。
   - 閱讀 `.specify/templates/tasks-template.md` 並確保任務分類反映新增或移除的原則驅動任務類型（例如：可觀測性、版本管理、測試紀律）。
   - 閱讀 `.specify/templates/commands/*.md` 中的每個命令檔（包含此檔）以驗證是否存在過時參照（例如專屬 agent 名稱如 CLAUDE）在需要通用指引時仍保留。
   - 閱讀任何執行時指導文件（例如 `README.md`、`docs/quickstart.md`，或任何存在的 agent 專屬指導檔案）。更新任何與已變更原則相關的參照。

5. 產生同步影響報告（在更新後將其以 HTML 註解形式置於章程檔案頂部）：
   - 版本變更：舊 → 新
   - 被修改的原則清單（若重新命名列出舊標題 → 新標題）
   - 新增章節
   - 移除章節
   - 需要更新的範本（✅ 已更新 / ⚠ 待處理）及檔案路徑
   - 若有任何佔位符刻意延後，列出後續 TODO

6. 最終輸出前的驗證：
   - 不得有遺留且未說明的方括號標記。
   - 版本行與報告相符。
   - 日期採用 ISO 格式 YYYY-MM-DD。
   - 原則應為陳述式、可檢測，並避免模糊語言（將 "should" 以適切理由改為 MUST/SHOULD）。

7. 將完成的章程寫回 `.specify/memory/constitution.md`（覆寫）。

8. 向使用者輸出最終摘要，其中包含：
   - 新版本與版本提升理由。
   - 任何被標記為需人工後續處理的檔案。
   - 建議的提交訊息（例如：docs: 修改憲章至 vX.Y.Z（原則新增 + 治理更新））。

格式與風格要求：
- 使用 Markdown 標題時，請完全依照範本格式（不要提升或降低層級）。
- 長的理由行請換行以維持可讀性（理想小於 100 字），但請勿用牽強的斷行強制執行。
- 各章節之間保留單一空行。
- 避免尾端空白。

若使用者提供部分更新（例如僅修改一個原則），仍需執行驗證與版本決策步驟。

若缺少關鍵資訊（例如 RATIFICATION_DATE 確實未知），請插入 `TODO(<FIELD_NAME>): explanation` 並在同步影響報告的延後項目中列出。

切勿建立新的範本；始終在既有的 `.specify/memory/constitution.md` 檔案上操作。
